# Lance-Ray Memory Architecture Diagram
# Lance-Ray å†…å­˜æ¶æ„å›¾

This document provides visual diagrams of the memory management architecture in lance-ray.

## System Architecture Overview / ç³»ç»Ÿæ¶æ„æ¦‚è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        CLIENT / å®¢æˆ·ç«¯                               â”‚
â”‚                                                                       â”‚
â”‚  Ray Dataset API                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  ds = ray.data.read_datasource(LanceDatasource(...))       â”‚    â”‚
â”‚  â”‚  ds.write_datasink(LanceDatasink(...))                     â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    LANCE-RAY LAYER / Lance-Ray å±‚                    â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚  LanceDatasource    â”‚          â”‚   LanceDatasink     â”‚          â”‚
â”‚  â”‚  æ•°æ®æº              â”‚          â”‚   æ•°æ®æ¥æ”¶å™¨         â”‚          â”‚
â”‚  â”‚                     â”‚          â”‚                     â”‚          â”‚
â”‚  â”‚  â€¢ Lazy Loading     â”‚          â”‚  â€¢ Fragment Writer  â”‚          â”‚
â”‚  â”‚  â€¢ Fragmentation    â”‚          â”‚  â€¢ Memory Limits    â”‚          â”‚
â”‚  â”‚  â€¢ Streaming        â”‚          â”‚  â€¢ Retry Logic      â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   RAY DISTRIBUTED LAYER / Ray åˆ†å¸ƒå¼å±‚                â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚  Worker 1    â”‚  â”‚  Worker 2    â”‚  â”‚  Worker N    â”‚             â”‚
â”‚  â”‚              â”‚  â”‚              â”‚  â”‚              â”‚             â”‚
â”‚  â”‚ Fragments    â”‚  â”‚ Fragments    â”‚  â”‚ Fragments    â”‚             â”‚
â”‚  â”‚ 1-10         â”‚  â”‚ 11-20        â”‚  â”‚ N-M          â”‚             â”‚
â”‚  â”‚              â”‚  â”‚              â”‚  â”‚              â”‚             â”‚
â”‚  â”‚ Memory:      â”‚  â”‚ Memory:      â”‚  â”‚ Memory:      â”‚             â”‚
â”‚  â”‚ ~100MB       â”‚  â”‚ ~100MB       â”‚  â”‚ ~100MB       â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   STORAGE LAYER / å­˜å‚¨å±‚                              â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚  Lance Format Files (Columnar Storage)                 â”‚         â”‚
â”‚  â”‚  Lance æ ¼å¼æ–‡ä»¶ï¼ˆåˆ—å¼å­˜å‚¨ï¼‰                              â”‚         â”‚
â”‚  â”‚                                                          â”‚         â”‚
â”‚  â”‚  ğŸ“ Dataset Directory                                   â”‚         â”‚
â”‚  â”‚     â”œâ”€â”€ _versions/                                      â”‚         â”‚
â”‚  â”‚     â”œâ”€â”€ _transactions/                                  â”‚         â”‚
â”‚  â”‚     â””â”€â”€ data/                                           â”‚         â”‚
â”‚  â”‚         â”œâ”€â”€ fragment-00001.lance                        â”‚         â”‚
â”‚  â”‚         â”œâ”€â”€ fragment-00002.lance                        â”‚         â”‚
â”‚  â”‚         â””â”€â”€ ...                                         â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                                       â”‚
â”‚  Supports: S3, Azure Blob, GCS, Local FS                            â”‚
â”‚  æ”¯æŒï¼šS3ã€Azure Blobã€GCSã€æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Memory Flow During Read / è¯»å–æ—¶çš„å†…å­˜æµ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 1: Dataset Initialization (No memory used)              â”‚
â”‚ æ­¥éª¤1ï¼šæ•°æ®é›†åˆå§‹åŒ–ï¼ˆä¸ä½¿ç”¨å†…å­˜ï¼‰                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â”‚ Lazy Loading / å»¶è¿ŸåŠ è½½
                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 2: First Access - Load Metadata Only                    â”‚
â”‚ æ­¥éª¤2ï¼šé¦–æ¬¡è®¿é—® - ä»…åŠ è½½å…ƒæ•°æ®                                 â”‚
â”‚                                                               â”‚
â”‚  self._lance_ds = lance.dataset(uri)                         â”‚
â”‚  fragments = ds.get_fragments()  # Just metadata             â”‚
â”‚                                                               â”‚
â”‚  Memory Used: ~1-10 MB / ä½¿ç”¨å†…å­˜ï¼šçº¦1-10 MB                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 3: Split Fragments Across Workers                       â”‚
â”‚ æ­¥éª¤3ï¼šè·¨Workeråˆ†é…ç‰‡æ®µ                                        â”‚
â”‚                                                               â”‚
â”‚  fragments = [F1, F2, F3, ..., F100]                         â”‚
â”‚               â”‚                                               â”‚
â”‚               â””â”€â–º Worker 1: [F1-F10]                         â”‚
â”‚               â””â”€â–º Worker 2: [F11-F20]                        â”‚
â”‚               â””â”€â–º Worker N: [F91-F100]                       â”‚
â”‚                                                               â”‚
â”‚  Memory Used: Minimal (just fragment IDs)                    â”‚
â”‚  ä½¿ç”¨å†…å­˜ï¼šæœ€å°ï¼ˆä»…ç‰‡æ®µIDï¼‰                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 4: Each Worker Streams Its Fragments                    â”‚
â”‚ æ­¥éª¤4ï¼šæ¯ä¸ªWorkeræµå¼å¤„ç†å…¶ç‰‡æ®µ                                â”‚
â”‚                                                               â”‚
â”‚  for batch in scanner.to_reader():                           â”‚
â”‚      yield batch  # Process one batch, then release          â”‚
â”‚                                                               â”‚
â”‚  Memory Per Worker: ~100-500 MB (bounded)                    â”‚
â”‚  æ¯ä¸ªWorkerå†…å­˜ï¼šçº¦100-500 MBï¼ˆå—é™ï¼‰                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 5: Results Returned/Aggregated                          â”‚
â”‚ æ­¥éª¤5ï¼šè¿”å›/èšåˆç»“æœ                                           â”‚
â”‚                                                               â”‚
â”‚  Total Memory = Worker Memory Ã— Parallelism                  â”‚
â”‚  æ€»å†…å­˜ = Workerå†…å­˜ Ã— å¹¶è¡Œåº¦                                  â”‚
â”‚                                                               â”‚
â”‚  Example: 500MB Ã— 10 workers = 5GB total                     â”‚
â”‚  ç¤ºä¾‹ï¼š500MB Ã— 10ä¸ªWorker = æ€»å…±5GB                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Memory Flow During Write / å†™å…¥æ—¶çš„å†…å­˜æµ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ INPUT: Large Dataset (e.g., 100GB)                           â”‚
â”‚ è¾“å…¥ï¼šå¤§å‹æ•°æ®é›†ï¼ˆä¾‹å¦‚ï¼Œ100GBï¼‰                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 1: Split into Tasks                                     â”‚
â”‚ æ­¥éª¤1ï¼šåˆ†å‰²æˆä»»åŠ¡                                              â”‚
â”‚                                                               â”‚
â”‚  Task 1: Rows 1-1M      â†’ Worker 1                          â”‚
â”‚  Task 2: Rows 1M-2M     â†’ Worker 2                          â”‚
â”‚  Task 3: Rows 2M-3M     â†’ Worker 3                          â”‚
â”‚  ...                                                          â”‚
â”‚                                                               â”‚
â”‚  max_rows_per_file = 1M (configurable)                       â”‚
â”‚  max_bytes_per_file = 90GB (configurable)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 2: Each Worker Processes Its Task                       â”‚
â”‚ æ­¥éª¤2ï¼šæ¯ä¸ªWorkerå¤„ç†å…¶ä»»åŠ¡                                    â”‚
â”‚                                                               â”‚
â”‚  Worker 1:                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚  â”‚ 1. Read batch from input (streaming)    â”‚                 â”‚
â”‚  â”‚    Memory: +50MB                        â”‚                 â”‚
â”‚  â”‚                                          â”‚                 â”‚
â”‚  â”‚ 2. Transform (if needed)                â”‚                 â”‚
â”‚  â”‚    Memory: +50MB                        â”‚                 â”‚
â”‚  â”‚                                          â”‚                 â”‚
â”‚  â”‚ 3. Write to fragment file               â”‚                 â”‚
â”‚  â”‚    Memory: +100MB (buffer)              â”‚                 â”‚
â”‚  â”‚                                          â”‚                 â”‚
â”‚  â”‚ 4. Flush and release                    â”‚                 â”‚
â”‚  â”‚    Memory: -200MB                       â”‚                 â”‚
â”‚  â”‚                                          â”‚                 â”‚
â”‚  â”‚ 5. Repeat for next batch                â”‚                 â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚                                                               â”‚
â”‚  Peak Memory Per Worker: ~200-500 MB                         â”‚
â”‚  æ¯ä¸ªWorkerå³°å€¼å†…å­˜ï¼šçº¦200-500 MB                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 3: Fragments Collected                                  â”‚
â”‚ æ­¥éª¤3ï¼šæ”¶é›†ç‰‡æ®µ                                                â”‚
â”‚                                                               â”‚
â”‚  Worker 1 â†’ [Fragment 1]                                     â”‚
â”‚  Worker 2 â†’ [Fragment 2]                                     â”‚
â”‚  Worker 3 â†’ [Fragment 3]                                     â”‚
â”‚  ...                                                          â”‚
â”‚                                                               â”‚
â”‚  Memory: Just fragment metadata (~1KB per fragment)          â”‚
â”‚  å†…å­˜ï¼šä»…ç‰‡æ®µå…ƒæ•°æ®ï¼ˆæ¯ç‰‡æ®µçº¦1KBï¼‰                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 4: Commit Transaction (Single Coordinator)              â”‚
â”‚ æ­¥éª¤4ï¼šæäº¤äº‹åŠ¡ï¼ˆå•åè°ƒå™¨ï¼‰                                     â”‚
â”‚                                                               â”‚
â”‚  lance.LanceDataset.commit(                                  â”‚
â”‚      uri,                                                     â”‚
â”‚      LanceOperation.Overwrite(schema, fragments)             â”‚
â”‚  )                                                            â”‚
â”‚                                                               â”‚
â”‚  Memory: ~10-100 MB (just metadata)                          â”‚
â”‚  å†…å­˜ï¼šçº¦10-100 MBï¼ˆä»…å…ƒæ•°æ®ï¼‰                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ OUTPUT: Lance Dataset on Storage                             â”‚
â”‚ è¾“å‡ºï¼šå­˜å‚¨ä¸Šçš„Lanceæ•°æ®é›†                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Memory Optimization Techniques / å†…å­˜ä¼˜åŒ–æŠ€æœ¯

### 1. Lazy Loading / å»¶è¿ŸåŠ è½½

```
Traditional Loading:          Lazy Loading:
ä¼ ç»ŸåŠ è½½ï¼š                    å»¶è¿ŸåŠ è½½ï¼š

Time 0: Load all data        Time 0: Store reference only
       â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                 Reference
       (100GB in memory)            (0 MB)
                                     â”‚
Time 1: Process data         Time 1: Load metadata
       â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                 â–ˆ (10 MB)
                                     â”‚
Time 2: ...                  Time 2: Load fragment 1
                                     â–ˆâ–ˆ (100 MB)
                                     â”‚
                             Time 3: Process, then release
                                     â–“ (freed)
                                     â”‚
                             Time 4: Load fragment 2
                                     â–ˆâ–ˆ (100 MB)
```

### 2. Fragment Parallelism / ç‰‡æ®µå¹¶è¡Œ

```
Single Worker (Sequential):      Multi-Worker (Parallel):
å•Workerï¼ˆé¡ºåºï¼‰ï¼š               å¤šWorkerï¼ˆå¹¶è¡Œï¼‰ï¼š

Worker 1: [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ]    Worker 1: [â–ˆâ–ˆâ–ˆâ–ˆ]
          (All data)                      (1/4 data)
          
Time: 100 minutes                Worker 2: [â–ˆâ–ˆâ–ˆâ–ˆ]
Peak Memory: 10GB                         (1/4 data)
                                 
                                 Worker 3: [â–ˆâ–ˆâ–ˆâ–ˆ]
                                          (1/4 data)
                                 
                                 Worker 4: [â–ˆâ–ˆâ–ˆâ–ˆ]
                                          (1/4 data)
                                 
                                 Time: 25 minutes
                                 Peak Memory: 2.5GB per worker
                                             (10GB distributed)
```

### 3. Streaming vs Batch Loading / æµå¼ vs æ‰¹é‡åŠ è½½

```
Batch Loading:                 Streaming:
æ‰¹é‡åŠ è½½ï¼š                     æµå¼ï¼š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Load 1M rows â”‚              â”‚ Load 1K rows â”‚
â”‚  100MB       â”‚              â”‚  100KB       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                             â”‚
       â–¼                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Process      â”‚              â”‚ Process      â”‚
â”‚  +50MB       â”‚              â”‚  +50KB       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                             â”‚
       â–¼                             â–¼
Total: 150MB                  â”‚ Free memory  â”‚
per batch                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                                     â–¼
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚ Load 1K rows â”‚
                              â”‚  100KB       â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                                    ...
                              
                              Total: 150KB
                              per batch
                              (1000x less!)
```

## Retry Logic Flow / é‡è¯•é€»è¾‘æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Attempt to Read/Write Fragment                               â”‚
â”‚ å°è¯•è¯»/å†™ç‰‡æ®µ                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ Success? â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                       â”‚
       YES                     NO
        â”‚                       â”‚
        â–¼                       â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Return  â”‚           â”‚ Retryable    â”‚
   â”‚ Result  â”‚           â”‚ Error?       â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                        â”‚
                   YES                      NO
                    â”‚                        â”‚
                    â–¼                        â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ Attempts < 10?â”‚         â”‚ Raise     â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚ Error     â”‚
                    â”‚                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                       â”‚
       YES                     NO
        â”‚                       â”‚
        â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Wait (expo-  â”‚        â”‚ Raise     â”‚
â”‚ nential      â”‚        â”‚ Error     â”‚
â”‚ backoff)     â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Retry        â”‚
â”‚ Operation    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â””â”€â”€â”€â”€â”€â”€â–º (Back to "Success?")

Wait Times:
ç­‰å¾…æ—¶é—´ï¼š
- Attempt 1: 0s
- Attempt 2: ~1s
- Attempt 3: ~2s
- Attempt 4: ~4s
- Attempt 5: ~8s
- Attempt 6: ~16s
- Attempt 7-10: ~32s (max)
```

## Comparison: Nanobot Agent Memory vs Lance-Ray Data Memory

### Nanobot Agent Memory Architecture / Nanobotä»£ç†å†…å­˜æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    AGENT / ä»£ç†                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚               â”‚               â”‚
         â–¼               â–¼               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Short-term    â”‚ â”‚ Working  â”‚ â”‚  Long-term     â”‚
â”‚  Memory        â”‚ â”‚ Memory   â”‚ â”‚  Memory        â”‚
â”‚  çŸ­æœŸè®°å¿†      â”‚ â”‚ å·¥ä½œè®°å¿†  â”‚ â”‚  é•¿æœŸè®°å¿†      â”‚
â”‚                â”‚ â”‚          â”‚ â”‚                â”‚
â”‚ â€¢ Last N msgs  â”‚ â”‚ â€¢ Currentâ”‚ â”‚ â€¢ Vector DB    â”‚
â”‚ â€¢ Buffer       â”‚ â”‚   task   â”‚ â”‚ â€¢ Embeddings   â”‚
â”‚ â€¢ LRU cache    â”‚ â”‚ â€¢ Contextâ”‚ â”‚ â€¢ Semantic     â”‚
â”‚                â”‚ â”‚          â”‚ â”‚   search       â”‚
â”‚ Size: ~1MB     â”‚ â”‚Size: ~1KBâ”‚ â”‚ Size: ~1GB+    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚               â”‚               â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ Prompt Constructionâ”‚
              â”‚ æç¤ºæ„å»º            â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ LLM Inference      â”‚
              â”‚ LLMæ¨ç†             â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Lance-Ray Data Memory Architecture / Lance-Rayæ•°æ®å†…å­˜æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   DATA PIPELINE / æ•°æ®ç®¡é“                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚               â”‚               â”‚
         â–¼               â–¼               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Fragment 1    â”‚ â”‚Fragment 2â”‚ â”‚  Fragment N    â”‚
â”‚  åˆ†ç‰‡1         â”‚ â”‚åˆ†ç‰‡2      â”‚ â”‚  åˆ†ç‰‡N         â”‚
â”‚                â”‚ â”‚          â”‚ â”‚                â”‚
â”‚ â€¢ Columnar     â”‚ â”‚â€¢ Columnarâ”‚ â”‚ â€¢ Columnar     â”‚
â”‚ â€¢ Lazy load    â”‚ â”‚â€¢ Lazy    â”‚ â”‚ â€¢ Lazy load    â”‚
â”‚ â€¢ Stream       â”‚ â”‚  load    â”‚ â”‚ â€¢ Stream       â”‚
â”‚                â”‚ â”‚â€¢ Stream  â”‚ â”‚                â”‚
â”‚ Size: ~100MB   â”‚ â”‚Size:     â”‚ â”‚ Size: ~100MB   â”‚
â”‚ per worker     â”‚ â”‚~100MB    â”‚ â”‚ per worker     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚               â”‚               â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ Parallel Processingâ”‚
              â”‚ å¹¶è¡Œå¤„ç†            â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ Aggregation/Write  â”‚
              â”‚ èšåˆ/å†™å…¥           â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Key Takeaways / å…³é”®è¦ç‚¹

### Lance-Ray Memory is for: / Lance-Rayå†…å­˜ç”¨äºï¼š
- âœ… **Large-scale data processing** / å¤§è§„æ¨¡æ•°æ®å¤„ç†
- âœ… **Distributed computation** / åˆ†å¸ƒå¼è®¡ç®—
- âœ… **File I/O optimization** / æ–‡ä»¶I/Oä¼˜åŒ–
- âœ… **Horizontal scaling** / æ°´å¹³æ‰©å±•

### Nanobot Memory is for: / Nanobotå†…å­˜ç”¨äºï¼š
- âœ… **Conversation history** / å¯¹è¯å†å²
- âœ… **Context retrieval** / ä¸Šä¸‹æ–‡æ£€ç´¢
- âœ… **Knowledge persistence** / çŸ¥è¯†æŒä¹…åŒ–
- âœ… **Agent reasoning** / ä»£ç†æ¨ç†

### They are NOT the same! / å®ƒä»¬ä¸ä¸€æ ·ï¼
Lance-ray = **Data** memory  
Nanobot = **Agent** memory

---

**For more details, see:** / æ›´å¤šè¯¦æƒ…è¯·å‚é˜…ï¼š
- `NANOBOT_MEMORY_ANALYSIS.md` - Overview
- `docs/LANCE_RAY_MEMORY_ARCHITECTURE.md` - Technical details
- `MEMORY_QUICK_REFERENCE.md` - Quick reference

